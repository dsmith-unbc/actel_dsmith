<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>1.2) Creating a distances matrix • actel</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="1.2) Creating a distances matrix">
<meta property="og:description" content="actel">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">actel</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.1.9027</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a-0_workspace_requirements.html">1.0) Preparing your data</a>
    </li>
    <li>
      <a href="../articles/a-1_study_area.html">1.1) Structuring the study area</a>
    </li>
    <li>
      <a href="../articles/a-2_distances_matrix.html">1.2) Creating a distances matrix</a>
    </li>
    <li>
      <a href="../articles/a-3_preload.html">1.3) The preload() function</a>
    </li>
    <li>
      <a href="../articles/b-0_explore.html">2.0) explore()</a>
    </li>
    <li>
      <a href="../articles/b-1_explore_processes.html">2.1) Processes behind explore()</a>
    </li>
    <li>
      <a href="../articles/b-2_explore_results.html">2.2) Inspecting the explore() results</a>
    </li>
    <li>
      <a href="../articles/c-0_migration.html">3.0) migration()</a>
    </li>
    <li>
      <a href="../articles/c-1_migration_processes.html">3.1) Processes behind migration()</a>
    </li>
    <li>
      <a href="../articles/c-2_migration_results.html">3.2) Inspecting the migration() results</a>
    </li>
    <li>
      <a href="../articles/c-3_migration_efficiency.html">3.3) One-way efficiency estimations</a>
    </li>
    <li>
      <a href="../articles/d-0_residency.html">4.0) residency()</a>
    </li>
    <li>
      <a href="../articles/d-1_residency_processes.html">4.1) Processes behind residency()</a>
    </li>
    <li>
      <a href="../articles/d-2_residency_results.html">4.2) Inspecting the residency() results</a>
    </li>
    <li>
      <a href="../articles/d-3_residency_efficiency.html">4.3) Multi-way efficiency estimations</a>
    </li>
    <li>
      <a href="../articles/e-0_manual_mode.html">5.0) Manual mode</a>
    </li>
    <li>
      <a href="../articles/f-0_post_functions.html">6.0) Beyond the three main analyses</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hugomflavio/actel/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>1.2) Creating a distances matrix</h1>
                        <h4 class="author">Hugo Flávio</h4>
            
            <h4 class="date">2020-09-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hugomflavio/actel/blob/master/vignettes/a-2_distances_matrix.Rmd"><code>vignettes/a-2_distances_matrix.Rmd</code></a></small>
      <div class="hidden name"><code>a-2_distances_matrix.Rmd</code></div>

    </div>

    
    
<div id="index" class="section level2">
<h2 class="hasAnchor">
<a href="#index" class="anchor"></a>Index</h2>
<ol style="list-style-type: decimal">
<li>
<a href="a-0_workspace_requirements.html">Preparing your data</a>
<ol style="list-style-type: decimal">
<li><a href="a-1_study_area.html">Structuring the study area</a></li>
<li><a href="a-2_distances_matrix.html"><strong>Creating a distances matrix</strong></a></li>
<li><a href="a-3_preload.html">The preload() function</a></li>
</ol>
</li>
<li>
<a href="b-0_explore.html">explore()</a>
<ol style="list-style-type: decimal">
<li><a href="b-1_explore_processes.html">Processes behind explore()</a></li>
<li><a href="b-2_explore_results.html">Inspecting the explore() results</a></li>
</ol>
</li>
<li>
<a href="c-0_migration.html">migration()</a>
<ol style="list-style-type: decimal">
<li><a href="c-1_migration_processes.html">Processes behind migration()</a></li>
<li><a href="c-2_migration_results.html">Inspecting the migration() results</a></li>
<li><a href="c-3_migration_efficiency.html">One-way efficiency estimations</a></li>
</ol>
</li>
<li>
<a href="d-0_residency.html">residency()</a>
<ol style="list-style-type: decimal">
<li><a href="d-1_residency_processes.html">Processes behind residency()</a></li>
<li><a href="d-2_residency_results.html">Inspecting the residency() results</a></li>
<li><a href="d-3_residency_efficiency.html">Multi-way efficiency estimations</a></li>
</ol>
</li>
<li><a href="e-0_manual_mode.html">Manual mode</a></li>
<li><a href="f-0_post_functions.html">Beyond the three main analyses</a></li>
</ol>
</div>
<div id="what-is-the-distances-matrix" class="section level2">
<h2 class="hasAnchor">
<a href="#what-is-the-distances-matrix" class="anchor"></a>What is the distances matrix?</h2>
<p>A distances matrix is a table that contains information on the distance (in metres) between every pair of spatial elements in your study area (i.e. your receiver stations and your release sites). It looks like the table below:</p>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">St.1</th>
<th align="right">St.2</th>
<th align="right">St.3</th>
<th align="right">St.4</th>
<th align="right">St.5</th>
<th align="right">St.6</th>
<th align="right">Release</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">St.1</td>
<td align="right">0</td>
<td align="right">1366</td>
<td align="right">3417</td>
<td align="right">6912</td>
<td align="right">8863</td>
<td align="right">9272</td>
<td align="right">2229</td>
</tr>
<tr class="even">
<td align="left">St.2</td>
<td align="right">1366</td>
<td align="right">0</td>
<td align="right">2051</td>
<td align="right">5545</td>
<td align="right">7497</td>
<td align="right">7906</td>
<td align="right">3569</td>
</tr>
<tr class="odd">
<td align="left">St.3</td>
<td align="right">3417</td>
<td align="right">2051</td>
<td align="right">0</td>
<td align="right">3528</td>
<td align="right">5479</td>
<td align="right">5888</td>
<td align="right">5621</td>
</tr>
<tr class="even">
<td align="left">St.4</td>
<td align="right">6912</td>
<td align="right">5545</td>
<td align="right">3528</td>
<td align="right">0</td>
<td align="right">1963</td>
<td align="right">2372</td>
<td align="right">9115</td>
</tr>
<tr class="odd">
<td align="left">St.5</td>
<td align="right">8863</td>
<td align="right">7497</td>
<td align="right">5479</td>
<td align="right">1963</td>
<td align="right">0</td>
<td align="right">408</td>
<td align="right">11067</td>
</tr>
<tr class="even">
<td align="left">St.6</td>
<td align="right">9272</td>
<td align="right">7906</td>
<td align="right">5888</td>
<td align="right">2372</td>
<td align="right">408</td>
<td align="right">0</td>
<td align="right">11476</td>
</tr>
<tr class="odd">
<td align="left">Release</td>
<td align="right">2229</td>
<td align="right">3569</td>
<td align="right">5621</td>
<td align="right">9115</td>
<td align="right">11067</td>
<td align="right">11476</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<dl>
<dt>Note:</dt>
<dd>The matrix is symmetric (i.e. the entries of the matrix are symmetric with respect to the main diagonal).
</dd>
<dd>The diagonal line is composed of 0’s as it represents the distance between an element and itself.
</dd>
<dd>You <strong>must</strong> have at least one release site, and the names of the release sites must be identical to those in your ‘spatial.csv’ and your ‘biometrics.csv’.
</dd>
</dl>
</div>
<div id="creating-your-distances-matrix" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-your-distances-matrix" class="anchor"></a>Creating your distances matrix</h2>
<p>There are two ways to create a distance matrix for actel: manually, or automatically. While the manual way is more prone to errors and can be tedious, the automatic way can take some time and requires some GIS knowledge. It is up to you to decide which way to use:</p>
<div id="the-manual-way" class="section level3">
<h3 class="hasAnchor">
<a href="#the-manual-way" class="anchor"></a>The manual way</h3>
<p>The manual way is simple. In your R session, move to the folder where you have your spatial file, and run the command <code>emptyMatrix</code>. This will read your spatial data and create a matrix that is in accordance with it. It is important that you create your template this way, as the column and row names of the distance matrix are essential for actel to recognise the data. Below is an example of a distances matrix created by <code>emptyMatrix</code>.</p>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">St.1</th>
<th align="right">St.2</th>
<th align="right">St.3</th>
<th align="right">St.4</th>
<th align="right">St.5</th>
<th align="right">St.6</th>
<th align="right">Release</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">St.1</td>
<td align="right">0</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">St.2</td>
<td align="right"></td>
<td align="right">0</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="left">St.3</td>
<td align="right"></td>
<td align="right"></td>
<td align="right">0</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">St.4</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right">0</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="left">St.5</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right">0</td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">St.6</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right">0</td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="left">Release</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>You can find the correspondence between the standard names (e.g. “St.1”, “St.2”) and your receivers by running <code><a href="../reference/loadSpatial.html">loadSpatial()</a></code> (see the ‘Standard.name’ column).</p>
<p>Now, you can either fill in the matrix directly in R or save it and edit it a spreadsheet editor (make sure to save the row names too!). To simplify the task, you can fill in the upper diagonal-half of the matrix, reload into R if you used an external editor, and then run <code>completeMatrix</code> on the edited object.</p>
<p>Here is how it works:</p>
<ol style="list-style-type: decimal">
<li>Fill in the top part of the matrix:</li>
</ol>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">St.1</th>
<th align="right">St.2</th>
<th align="right">St.3</th>
<th align="right">St.4</th>
<th align="right">St.5</th>
<th align="right">St.6</th>
<th align="right">Release</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">St.1</td>
<td align="right">0</td>
<td align="right">1366</td>
<td align="right">3417</td>
<td align="right">6912</td>
<td align="right">8864</td>
<td align="right">9273</td>
<td align="right">2230</td>
</tr>
<tr class="even">
<td align="left">St.2</td>
<td align="right"></td>
<td align="right">0</td>
<td align="right">2051</td>
<td align="right">5546</td>
<td align="right">7498</td>
<td align="right">7906</td>
<td align="right">3570</td>
</tr>
<tr class="odd">
<td align="left">St.3</td>
<td align="right"></td>
<td align="right"></td>
<td align="right">0</td>
<td align="right">3528</td>
<td align="right">5480</td>
<td align="right">5889</td>
<td align="right">5621</td>
</tr>
<tr class="even">
<td align="left">St.4</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right">0</td>
<td align="right">1963</td>
<td align="right">2372</td>
<td align="right">9116</td>
</tr>
<tr class="odd">
<td align="left">St.5</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right">0</td>
<td align="right">409</td>
<td align="right">11068</td>
</tr>
<tr class="even">
<td align="left">St.6</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right">0</td>
<td align="right">11476</td>
</tr>
<tr class="odd">
<td align="left">Release</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: decimal">
<li>Run <code><a href="../reference/completeMatrix.html">completeMatrix()</a></code> on the half-filled matrix:</li>
</ol>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">St.1</th>
<th align="right">St.2</th>
<th align="right">St.3</th>
<th align="right">St.4</th>
<th align="right">St.5</th>
<th align="right">St.6</th>
<th align="right">Release</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">St.1</td>
<td align="right">0</td>
<td align="right">1366</td>
<td align="right">3417</td>
<td align="right">6912</td>
<td align="right">8864</td>
<td align="right">9273</td>
<td align="right">2230</td>
</tr>
<tr class="even">
<td align="left">St.2</td>
<td align="right">1366</td>
<td align="right">0</td>
<td align="right">2051</td>
<td align="right">5546</td>
<td align="right">7498</td>
<td align="right">7906</td>
<td align="right">3570</td>
</tr>
<tr class="odd">
<td align="left">St.3</td>
<td align="right">3417</td>
<td align="right">2051</td>
<td align="right">0</td>
<td align="right">3528</td>
<td align="right">5480</td>
<td align="right">5889</td>
<td align="right">5621</td>
</tr>
<tr class="even">
<td align="left">St.4</td>
<td align="right">6912</td>
<td align="right">5546</td>
<td align="right">3528</td>
<td align="right">0</td>
<td align="right">1963</td>
<td align="right">2372</td>
<td align="right">9116</td>
</tr>
<tr class="odd">
<td align="left">St.5</td>
<td align="right">8864</td>
<td align="right">7498</td>
<td align="right">5480</td>
<td align="right">1963</td>
<td align="right">0</td>
<td align="right">409</td>
<td align="right">11068</td>
</tr>
<tr class="even">
<td align="left">St.6</td>
<td align="right">9273</td>
<td align="right">7906</td>
<td align="right">5889</td>
<td align="right">2372</td>
<td align="right">409</td>
<td align="right">0</td>
<td align="right">11476</td>
</tr>
<tr class="odd">
<td align="left">Release</td>
<td align="right">2230</td>
<td align="right">3570</td>
<td align="right">5621</td>
<td align="right">9116</td>
<td align="right">11068</td>
<td align="right">11476</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: decimal">
<li>Save the complete matrix as ‘distances.csv’ in the folder that has the remaining actel data.</li>
</ol>
<dl>
<dt>Note:</dt>
<dd>The distance values <strong>must</strong> be in metres!
</dd>
</dl>
</div>
<div id="the-automatic-way" class="section level3">
<h3 class="hasAnchor">
<a href="#the-automatic-way" class="anchor"></a>The automatic way</h3>
<p>As your studies start having more and more receivers, it might get complicated to find and write down the distances between every single combination of receivers and release sites. To avoid doing this manually, you can get R to do it for you. To get R to compute the distances for you, you will need:</p>
<ol style="list-style-type: decimal">
<li>A shapefile with a land polygon of your study area.</li>
<li>The coordinates of your receivers and release sites in <strong>the same coordinate system as the shapefile</strong>.</li>
</ol>
<p>If you are not familiar with shapefiles and GIS, it might be a good idea to ask for a colleague’s help.</p>
<div id="preparing-the-shapefile" class="section level4">
<h4 class="hasAnchor">
<a href="#preparing-the-shapefile" class="anchor"></a>Preparing the shapefile</h4>
<p>To begin, you need to create a shapefile that extends over all your receivers and release sites. This shapefile is expected to contain polygons of the land masses, which means that your rivers, lakes, fjords and any water bodies must be “empty space”. The width of your water channels is important, as the shapefile will be converted into a raster later on (i.e. a image made of pixels). If your pixels represent squares of 30 by 30 metres, and your channel width originally was of five metres, then the river path will be lost during the conversion process. Try to ensure, as best as possible, that the corners of your shapefile are aligned (i.e. the shape as a rectangular/quadrangular form).</p>
<dl>
<dt>Note:</dt>
<dd>Make sure that the shapefile is in the same coordinate system as the points in your spatial file!
</dd>
</dl>
<p>Below is an example of the study area in the left, and the respective shapefile in the right:</p>
<p><img src="distances_shape_1.png" alt="drawing" width="330"><img src="distances_shape_2.png" alt="drawing" width="330"></p>
<p>Once you have your shapefile ready, copy the shapefile and respective auxiliary files to the folder where you have your ‘spatial.csv’. Do make sure to copy the auxiliary files, as they contain information regarding the coordinate system of the shapefile!</p>
<div id="preparing-the-spatial-csv-file" class="section level5">
<h5 class="hasAnchor">
<a href="#preparing-the-spatial-csv-file" class="anchor"></a>Preparing the spatial.csv file</h5>
<p>In your spatial file, you must include two columns with the coordinates for your receiver stations and release sites. These coordinates <strong>must</strong> be in the same coordinate system as the shapefile you just created before. Later on, you will need to know the <em>column names</em> of the columns that contain the X and Y coordinates.</p>
</div>
</div>
<div id="importing-the-shapefile-and-preparing-it" class="section level4">
<h4 class="hasAnchor">
<a href="#importing-the-shapefile-and-preparing-it" class="anchor"></a>Importing the shapefile and preparing it</h4>
<p>Now that both your shapefile and your spatial.csv file are ready, lets get back to R. The first thing you need to do is import your shapefile and convert to a raster. I have created a function that can perform these steps for you, called <code>loadShape</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw">base.raster</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/loadShape.html">loadShape</a></span>(<span class="kw">shape</span>, <span class="kw">size</span>, <span class="kw">spatial</span>, <span class="kw">coord.x</span>, <span class="kw">coord.y</span>, <span class="kw">buffer</span>)
</pre></div>
<ol style="list-style-type: decimal">
<li><p>The <code>shape</code> is the name of your shapefile, including the “.shp” extension.</p></li>
<li>
<p>The <code>size</code> determines the size of the raster’s pixels.</p>
<p>For example, if <code>size = 20</code>, then each pixel will have 20 by 20 meters.</p>
<p>Keep in mind that your pixel size must allow R to still capture the presence of your river channels. If the river channels are too slim, you can go back to your shapefile and artificially enlarge them.</p>
</li>
<li><p>The <code>coord.x</code> and <code>coord.y</code> allow actel to search your spatial.csv file and match the station positions with the extent of the shapefile. Write the names of the columns containing the x and y coordinates in these two arguments to activate these checks.</p></li>
<li><p>The <code>buffer</code> allows you to request an expansion of the shapefile limits (can come in handy to ensure your stations are not cut-off from each other).</p></li>
</ol>
<p>Once the shapefile is successfully loaded, you can have a quick look at the resulting raster by running <code><a href="https://rdrr.io/pkg/raster/man/plot.html">raster::plot()</a></code>; i.e.:</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="kw">raster</span>::<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span>(<span class="kw">base.raster</span>)
</pre></div>
<p>This should show you a plot where only the water areas are painted. Some water may show up around the edges of the original shapefile due to the range adjustments made by loadShape. Converting a shapefile into a raster can take a while, specially if the original shapefile is very big and the pixel size is low.</p>
</div>
<div id="creating-a-transition-layer" class="section level4">
<h4 class="hasAnchor">
<a href="#creating-a-transition-layer" class="anchor"></a>Creating a transition layer</h4>
<p>A transition layer is an object that allows R to estimate least cost paths between two locations. Using the raster generated above, creating a transition layer is straight forward:</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw">t.layer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transitionLayer.html">transitionLayer</a></span>(<span class="kw">base.raster</span>, directions = <span class="fl">16</span>)
</pre></div>
<ol style="list-style-type: decimal">
<li>
<p>The <code>directions</code> determine the complexity of R’s distance tracking techniques. It can take one of four values: four, eight or sixteen, defaulting to the latter.</p>
<ul>
<li>If <code>directions = 4</code>, the animal can only in the direction of the cardinal winds (North, South, East and West).</li>
<li>If <code>directions = 8</code>, the animal can also move in a intercardinal wind direction (Northeast, Northwest, Southeast and Southwest).</li>
<li>If <code>directions = 16</code>, then the animal can also move in the eight half-winds’ directions.</li>
</ul>
<p>Increasing the <code>directions</code> improves the distance estimation fidelity, but also increases computation time.</p>
</li>
</ol>
<p>Transition layers can take a long time to compute, especially for larger rasters, so you may have to bear with your computer for a bit here. To avoid having to go through this process multiple times, it may be a good idea to save the output of loadShape and transitionLayer in a separate RData file, for later use.</p>
</div>
<div id="creating-the-distances-matrix" class="section level4">
<h4 class="hasAnchor">
<a href="#creating-the-distances-matrix" class="anchor"></a>Creating the distances matrix</h4>
<p>Once you have your transition layer, you can use it to calculate multiple distances matrices, as long as the target objects fall within the extent of the original shapefile, and all targets are within water. To create your distances matrix, you must run <code>distancesMatrix</code> in the same working directory as your ‘spatial.csv’ file. This will allow it you automatically load the spatial file into the function environment.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="kw">dist.mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distancesMatrix.html">distancesMatrix</a></span>(<span class="kw">t.layer</span>, <span class="kw">coord.x</span>, <span class="kw">coord.y</span>)
</pre></div>
<p>The <code>t.layer</code> is the transition layer you just calculated. Fill in the column names of the X and Y coordinates of your ‘spatial.csv’ file in <code>coord.x</code> and <code>coord.y</code>. When you run this command, actel will ask you if you want to save the output to a ‘distances.csv’ file. Alternatively, you can check the output within R and then save the matrix yourself!</p>
<p>Actel will automatically recognise the ‘distances.csv’ file and activate speed calculations in your next analysis!</p>
<dl>
<dt>Note:</dt>
<dd>It is important that you check the results of this process by inspecting your distances matrix. If the distances do not look correct, you may have accidentally done something wrong in the steps above.
</dd>
</dl>
<p>Here is a minimum example:</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="co"># move to a temporary directory to avoid</span>
<span class="co"># overwriting local files</span>
<span class="kw">old.wd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span>()
<span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span>())

<span class="co"># Fetch the location of actel's example files</span>
<span class="kw">aux</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(package = <span class="st">"actel"</span>)[<span class="fl">1</span>]

<span class="co"># deploy the example spatial.csv file</span>
<span class="fu"><a href="https://rdrr.io/r/base/files.html">file.copy</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="kw">aux</span>, <span class="st">"/example_spatial.csv"</span>), <span class="st">"spatial.csv"</span>)

<span class="co"># import the example shapefile and use the spatial.csv file to check</span>
<span class="co"># the extents.</span>
<span class="kw">base.raster</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/loadShape.html">loadShape</a></span>(path = <span class="kw">aux</span>, shape = <span class="st">"example_shapefile.shp"</span>, 
coord.x = <span class="st">"x"</span>, coord.y = <span class="st">"y"</span>, size = <span class="fl">20</span>)

<span class="co"># You can have a look at the resulting raster by running</span>
<span class="kw">raster</span>::<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span>(<span class="kw">base.raster</span>)
<span class="co"># There should be two small islands in the bottom left area</span>

<span class="co"># Build the transition layer</span>
<span class="kw">t.layer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transitionLayer.html">transitionLayer</a></span>(<span class="kw">base.raster</span>)

<span class="co"># compile the distances matrix. Columns x and y in the spatial dataframe</span>
<span class="co"># contain the coordinates of the stations and release sites.</span>
<span class="kw">dist.mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distancesMatrix.html">distancesMatrix</a></span>(<span class="kw">t.layer</span>, coord.x = <span class="st">'x'</span>, coord.y = <span class="st">'y'</span>)

<span class="co"># check out the output:</span>
<span class="kw">dist.mat</span>

<span class="co"># And return to your old working directory once done :)</span>
<span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span>(<span class="kw">old.wd</span>)
<span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="kw">old.wd</span>)
</pre></div>
<p>Remember that you can find more information about each of these functions by visiting their help pages. You can access the help pages by running <code><a href="../reference/loadShape.html">?loadShape</a></code>, <code><a href="../reference/transitionLayer.html">?transitionLayer</a></code> or <code><a href="../reference/distancesMatrix.html">?distancesMatrix</a></code>.</p>
<p><strong><a href="javascript:history.back()">Return to previous page</a></strong></p>
<p><a href="#">Back to top.</a></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Hugo Flávio.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
