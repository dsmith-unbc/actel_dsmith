---
title: "4) Inspecting the Results"
author: "Hugo FlÃ¡vio"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{4) Inspecting the Results}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

## Index

1. [Preparing your data](1.0.workspace_requirements.html)
    1. [Structuring the study area](1.1.study_area.html)
    1. [Creating a distances matrix](1.2.distances_matrix.html)
1. [Running actel](2.0.running_analysis.html)
1. [What is actel doing?](3.0.the_sorting_process.html)
    1. [Errors and messages](3.1.messages.html)
1. [**Inspecting the results**](4.inspecting_results.html)
1. [Refining the results](5.refining_results.html)

## Results within R

If you ran the actel function and stored it into an object, this object will now be a list, containing all the useful results actel has compiled for you:

### detections

The `detections` object is a list of the raw detections found in your detections file, split by each of the target tags. This is the base data with which actel worked. Here is an example:

|Timestamp           |Receiver |CodeSpace |Signal |Transmitter |Standard.Name |Array  |
|:-------------------|:--------|:---------|:------|:-----------|:-------------|:------|
|2018-04-18 19:07:45 |130763   |R64K      |4701   |R64K-4701   |St.2          |River1 |
|2018-04-18 19:08:06 |130763   |R64K      |4701   |R64K-4701   |St.2          |River1 |
|2018-04-18 19:56:39 |130766   |R64K      |4701   |R64K-4701   |St.7          |River1 |
|2018-04-18 20:01:11 |126324   |R64K      |4701   |R64K-4701   |St.5          |River1 |
|2018-04-18 20:13:43 |126324   |R64K      |4701   |R64K-4701   |St.5          |River1 |
|2018-04-18 20:15:11 |126324   |R64K      |4701   |R64K-4701   |St.5          |River1 |


### movements

The `movements` object is a list of the movement events created during [the sorting process](3.0.the_sorting_process.html#from-detections-to-movements). These records can become very useful if you need to go back to a given fish and inspect the movements in more detail. Here is an example:

|Array  | Detections|First station |Last station |First time          |Last time           |Time travelling |Time on array |
|:------|----------:|:-------------|:------------|:-------------------|:-------------------|:---------------|:-------------|
|River1 |         92|St.2          |St.2         |2018-04-18 19:07:45 |2018-04-18 23:27:29 |NA              |4:19          |
|River2 |          1|St.11         |St.11        |2018-04-18 23:49:16 |2018-04-18 23:49:16 |0:21            |-             |
|River3 |          3|St.12         |St.12        |2018-04-19 01:52:34 |2018-04-19 01:57:01 |2:03            |0:04          |
|River4 |         10|St.13         |St.13        |2018-04-19 03:35:44 |2018-04-19 03:42:17 |1:38            |0:06          |
|Bay1   |         52|St.16         |St.17        |2018-04-20 05:33:51 |2018-04-20 06:12:20 |25:51           |0:38          |
|Bay1   |         69|St.17         |St.16        |2018-04-20 12:00:31 |2018-04-20 13:00:36 |5:48            |1:00          |

### status.df

The `status.df` is a dataframe that combines both the [timetable data and your biometrics](3.0.the_sorting_process.html#combining-the-time-data-with-the-biometrics) into a single, organised table. If you have stored any comments during the analysis process, they will show up in a reserved column in this table. The `status.df` also contains the recorded fate for each fish (i.e. died somewhere or succeeded at crossing the study area), and summary information on the number and length of the recorded upstream movements. This table can be quite big, so we did not include an example here.

### group.overview

This small table is automatically generated with data extracted from the `status.df`. For each fish group, it details the number of fish that disappeared on any section and those that passed to the next. It is very helpful to get a quick overview of the results, and is incorporated in the [actel report](#actel_report.pdf-if-report-true). Here is an example:

|         | Total| Disap..in.River| Migrated.to.Sea| Disap..in.Sea| Succeeded|
|:--------|-----:|---------------:|---------------:|-------------:|---------:|
|Hatchery |    40|              30|              10|             3|         7|
|Wild     |    40|              24|              16|             2|        14|

### progression

The progression is also automatically generated. For each group and release site, you can see detailed information of how many fish were last seen on each receiver array (i.e. rows 1 and 3), and how many fish reached the next one (i.e. rows 2 and 4). Here is an example:

|                        | Total| Release| River1| River2| River3| River4| Sea1| Sea2|
|:-----------------------|-----:|-------:|------:|------:|------:|------:|----:|----:|
|Hatchery-RS1.last.array |     0|      15|      5|      3|      5|      2|    3|    7|
|Hatchery-RS1.remaining  |    40|      25|     20|     17|     12|     10|    7|    0|
|Wild-RS1.last.array     |     0|      10|      4|      2|      6|      2|    2|   14|
|Wild-RS1.remaining      |    40|      30|     26|     24|     18|     16|   14|    0|

The interpretation of the table above can be a bit tricky, especially if there are many groups of fish and/or release sites. For this reason, if you activated the [report](2.0.running_analysis.html#report) option, this table is then converted into a graphic, which can be found in the actel report.

### efficiency

Actel calculates three levels of efficiency: inter-section, inter-array and intra-array. As the fish detected in the section/array downstream of the current section/array are used as a base for efficiency calculations, efficiency cannot be calculated for the last section/array. This does not apply for intra-array efficiency, where the detections in the receivers that make up an array are matched against each other.

To improve the accuracy of the efficiency measurements, actel calculates forward efficiency only. This means that, for each fish, only the first forward movement is considered. Let's have a look at these examples:

<img src="efficiency_a.svg" alt="drawing" width="330"/> <img src="efficiency_b.svg" alt="drawing" width="330"/>

In example **A**, the fish moved out to sea, and was detected at the array River1 and Fjord2, but not at Fjord1. This is considered a missed event for Fjord1. Even if the fish then moved backwards and ended up being detected at Fjord1 at a later time (example **B**), since the first expected detection was missed, this fish will still be considered as missed by Fjord1, in what concerns efficiency calculations.

These efficiency calculations are dependant on the way how you organise your hydrophones. To learn more about how to organise your study area in an actel-friendly way, have a look at [this manual page.](1.1.study_area.html)

### spatial

The `spatial` object is a list containing the stations, release sites and some more summary information. This object may come in handy if you have to go back to your results some time after you completed the analysis, so you can verify the study area design and match the stations names to their locations.

## Results in your working directory

On top of the results stored in your R session, actel saves some additional information in your working directory.

### actel_results.RData

To make sure that you don't accidentally loose your results, actel stores them right away in the target folder. The results present in this file are the same as the ones you obtain directly in your R console (see above).

### actel.log.txt

This log is where actel has written what was done during the analysis. It contains everything: summary information, errors, warnings and messages and the options you have taken while the analysis was running. It is worth keeping it in case you need to find out the reasoning behind some result. To avoid overwriting when conducting multiple analysis, the actel.log.txt file is preceded by the timestamp of when it was created (e.g. '2019-05-14.10.51.40.actel.log').

### stray_tags.csv

Depending on how closed your study area is, the deployed hydrophones may pick up stray tags that came in range during the study period. Actel stores a brief summary of these tags in this .csv file, in case you are interested in knowing which tags these were, and perhaps want to share the codes with your colleagues.

### actel_report.html (if report = TRUE)

This is the main non-R output. If you activated the `report` option, actel will compile a html report for you. This report contains the following sections:

1. **Summary**

  Contains brief information on the study. It is useful to check up if anything looks wrong (i.e. the number of target tags, the data range).

1. **Stations** and **Releases**

	A table containing the spatial elements of the study (i.e. receivers and release sites). Any unknown hydrophones found during the analysis will also show up here. Since the station names can vary wildly, actel creates Standard names for your stations (e.g. "St.1","St.2"). When looking at the individual detection graphics, you can refer back to this table to match the standard names with the hydrophone serial numbers.

1. **Array forward efficiency**

	Here you can see how efficient your receivers were at detecting the fish that moved past them. This is simply a visual representation of the tables displayed in the [efficiency object](#efficiency), which is in your results in R.

1. **Warning messages**

	These represent warnings, errors and particularly important messages that were displayed during the analysis. By having them extracted and put together here, you can easily find out what went wrong.

1. **User comments**

	Should you type in any comments during the analysis, they will be displayed here, so you can quickly remember that lingering detail that you wrote while looking at the fish's movement table.

1. **Biometrics**

	Actel crawls through you biometrics file in search for columns containing the keywords *length*, *weight* or *mass*. Should it find any matching column, it will print boxplots of the distribution of the selected parameters, divided by each fish group listed in the same file. This can be very helpful in quickly finding typos in the data (e.g. a displaced decimal separator).

1. **Survival**

	The survival is displayed both as a table and a figure, both of which use the content of the [group.overview object](#group.overview), which is in your results in R.

1. **Progression**

	The progression plot is a visual representation of the [progression object](#progression), which is in your results in R. As an added bonus, the progression plot has a dashed black line representing the point after which the fish were considered to have succeeded. This plot will be divided by fish groups and release sites. Note, if some of your fish were released half-way through the study area, the arrays behind the release site should appear empty in the progression plot (unless there were backwards movements).

1. **Fish comparisons (Dotplots)**

	As the name suggests, this plot compares a series of variables across all your fish: The total number of detections, and the time until/time in each of your study area sections. To simplify the visualisation, for each variable, the **top 10%** of the data is painted in **Red**, and the **bottom 10%** of the data is painted in **Orange**.

	This plot is meant to help you find fish with uncommon behaviour. Fish with a lot of detections are likely staying for a very long time within hydrophone range; a fish that moves too fast in comparison to the remaining may have been carried inside a predator. It is up to you to look at these graphics and decide if anything looks odd. If it does, then save the tag number, so you can have a closer look at the respective detections plot.

1. **Actel log**

	This section contains the same information as the actel log saved as a text file in your target folder. It is useful to have a look at a few things. Amongst them are the number of target tags, the detection data range, the number of ALS (i.e. hydrophones). These can help you spot any missing data (i.e. if you tagged 100 fish and had only 80 target tags, some tags are missing).

1. **Graphics of detected tags**

	This section contains a plot for each of your target tags, showing all the detections found in the data for the respective fish. Further more, it shows the release time in the black dashed line, and the times picked by actel as entry/exit of each section in the grey dashed lines. Lastly, the fate assigned by actel to the fish is displayed in the header, between brackets.

	We recommend that you go through all of these graphics and verify that everything is looking ok (i.e. actel has assigned fates and entry/exit points correctly). This is also a good chance to have a closer look at the tags you flagged as suspicious above.

	Note that fish where you had to manually intervene during the analysis will be highlighted with a yellow border, and fish that were manually overridden through the `override` command will be highlighted with a red border.

	If you find out that actel has miss-assigned something, you can act upon it, as we will see further below.

### 'Report' folder (if report = TRUE)

Activating the `report` option will trigger the creation of this folder. This folder contains all the pieces used to build the actel report we just presented above. If the compiling of the html report fails for some reason, you can always look at the individual graphics in this folder.

## What if actel has miss-assigned something?

In actel, the last call is always yours. Although we have done our best to ensure that actel assigns all the fates right, fish with strange behaviour can be complicated. If you disagree with any of the assigned times of entry/exit of a section, of with the fate assigned to the fish, you can always [enter manual mode and tell actel what to do.](5.refining_results.html)

[Back to top.](#)